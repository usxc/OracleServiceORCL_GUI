# Oracle Service Controller GUI

## 概要

Windows上で特定のOracleサービス（デフォルト: `OracleServiceORCL`）の状態を監視し、GUIを通じて簡単にサービスの開始・停止操作を行うためのシンプルなツールです。

## 主な機能

* 対象サービスの現在の状態（RUNNING, STOPPED など）をリアルタイムで表示
* サービス状態の定期的な自動更新（デフォルト: 10秒ごと）
* GUI上のボタンクリックによる簡単なサービス開始・停止操作
* サービス操作中のプログレスバー表示
* 実行した操作や状態チェックのログをGUI内に表示
* 起動時に管理者権限があるかチェックし、ない場合は警告を表示
* サービスの開始/停止操作時に管理者権限がない場合はエラーメッセージを表示

## 動作環境

* **OS:** Windows
    * Windowsのサービス管理コマンド `sc.exe` を利用しています。
    * 管理者権限チェックに `ctypes` を利用しています。
* **Python:** 3.x (例: 3.12 で開発・テスト)

## 依存関係

Python 標準ライブラリのみを使用しています。追加のライブラリインストールは不要です。

* tkinter
* subprocess
* threading
* time
* sys
* ctypes

## 使い方

**重要:** このアプリケーションでサービスの開始・停止を行うには、**管理者権限が必要**です。

以下のいずれかの方法で起動してください。

### 1. スクリプトを直接実行 (要 管理者権限)

1.  コマンドプロンプト (cmd) または PowerShell を **管理者として実行** します。
2.  このスクリプト (`OracleServiceORCL_GUI.py`) が保存されているディレクトリに移動します。
    ```shell
    cd C:\path\to\your\script
    ```
3.  以下のコマンドを実行します。
    ```shell
    python OracleServiceORCL_GUI.py
    ```

### 2. ショートカットを作成して実行 (推奨)

この方法が、日常的に使う場合に最も簡単です。

1.  `OracleServiceORCL_GUI.py` ファイルを右クリックし、「ショートカットの作成」を選択します。
2.  作成されたショートカットを右クリックし、「プロパティ」を選択します。
3.  「ショートカット」タブの「リンク先(T):」を以下のように編集します。（`pythonw.exe` のパスとスクリプトのパスはご自身の環境に合わせてください）
    * 例: `C:\Users\YourUser\AppData\Local\Programs\Python\Python312\pythonw.exe C:\mywork\OracleServiceORCL_GUI\OracleServiceORCL_GUI.py`
    * （`pythonw.exe` を使うと、実行時に背後に黒いコンソールウィンドウが表示されません）
4.  「詳細設定(V)...」ボタンをクリックします。
5.  「管理者として実行(R)」にチェックを入れ、「OK」をクリックします。
6.  プロパティウィンドウで「適用」または「OK」をクリックします。
7.  作成されたショートカットをダブルクリックすると、ユーザーアカウント制御(UAC)の確認ダイアログが表示された後、アプリケーションが管理者権限で起動します。

### 3. (オプション) 実行ファイル (.exe) に変換して実行

Pythonがインストールされていない環境でも実行できるように、`.exe` ファイルを作成することができます。

1.  **PyInstallerをインストール:**
    ```shell
    pip install pyinstaller
    ```
2.  **`.exe` ファイルを作成:**
    コマンドプロンプトでスクリプトのあるディレクトリに移動し、以下のコマンドを実行します。
    ```shell
    pyinstaller --onefile --windowed --noconsole OracleServiceORCL_GUI.py
    ```
    * `--onefile`: 関連ファイルを1つの `.exe` にまとめます。
    * `--windowed` または `--noconsole`: GUIアプリ実行時に背後のコンソールウィンドウを表示しません。
    * `--icon=your_icon.ico`: (オプション) アイコンを指定する場合。
3.  **実行:**
    * `dist` フォルダ内に作成された `.exe` ファイルを、**右クリックして「管理者として実行」** を選択して起動します。

## 設定

スクリプト内の以下の定数を変更することで、動作をカスタマイズできます。

* `TARGET_SERVICE_NAME`: 監視・操作対象のサービス名を変更できます。（デフォルト: `"OracleServiceORCL"`）
* `MONITOR_TIMEOUT`: サービス開始/停止後の状態監視タイムアウト時間（秒）を変更できます。（デフォルト: `180`）
* `CHECK_INTERVAL`: サービス状態の自動チェック間隔（ミリ秒）を変更できます。（デフォルト: `10000` = 10秒）
* `POLLING_INTERVAL`: サービス開始/停止操作中の状態ポーリング間隔（秒）を変更できます。（デフォルト: `1`）

## 注意点

* 本ツールはWindows環境専用です。
* サービス操作には管理者権限が必須です。
* 指定したサービス名が存在しない場合、エラーが表示されます。
* `sc.exe` コマンドへのパスが通っている必要があります（通常は問題ありません）。
